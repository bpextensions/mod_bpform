<?xml version="1.0" encoding="utf-8"?>
<extension type="module" client="site" method="upgrade">
    <name>mod_bpform</name>
    <author>${author.name}</author>
    <creationDate>${build.date}</creationDate>
    <copyright>Copyright (C) ${build.year} ${copyrights}. All rights reserved.</copyright>
    <license>${license.name}, see ${license.url}</license>
    <authorEmail>${author.email}</authorEmail>
    <authorUrl>${author.url}</authorUrl>
    <version>${build.version}</version>
    <description>MOD_BPFORM_XML_DESCRIPTION</description>

    <namespace path="src">BPExtensions\Module\BPForm</namespace>

    <files>
        <folder>forms</folder>
        <folder>language</folder>
        <folder>services</folder>
        <folder module="mod_bpform">src</folder>
        <folder>tmpl</folder>
    </files>

    <languages folder="language">
        <language tag="pl-PL">pl-PL/mod_bpform.ini</language>
        <language tag="pl-PL">pl-PL/mod_bpform.sys.ini</language>
        <language tag="en-GB">en-GB/mod_bpform.ini</language>
        <language tag="en-GB">en-GB/mod_bpform.sys.ini</language>
    </languages>

    <config>
        <fields name="params">
            <fieldset name="basic"
                      addruleprefix="BPExtensions\Module\BPForm\Site\Form\Rule"
            >
                <field
                        addfieldprefix="BPExtensions\Module\BPForm\Site\Form\Field"
                        name="donate"
                        type="BPDonate"
                />
                <field name="recipient" type="radio"
                       default="contact" class="btn-group"
                       label="MOD_BPFORM_BASIC_FIELD_RECIPIENT_LABEL"
                       description="MOD_BPFORM_BASIC_FIELD_RECIPIENT_DESC"
                       filter="WORD">
                    <option value="contact">MOD_BPFORM_BASIC_FIELD_RECIPIENT_OPTION_CONTACT</option>
                    <option value="emails">MOD_BPFORM_BASIC_FIELD_RECIPIENT_OPTION_EMAILS</option>
                </field>
                <field
                        name="recipient_contact"
                        type="modal_contact"
                        select="true" new="true" edit="true" clear="true"
                        showon="recipient:contact"
                        label="MOD_BPFORM_BASIC_FIELD_RECIPIENT_CONTACT_LABEL"
                        description="MOD_BPFORM_BASIC_FIELD_RECIPIENT_CONTACT_DESC"
                        addfieldprefix="Joomla\Component\Contact\Administrator\Field"
                />
                <field
                        name="recipient_emails"
                        showon="recipient:emails"
                        type="subform"
                        label="MOD_BPFORM_BASIC_FIELD_RECIPIENT_EMAILS_LABEL"
                        description="MOD_BPFORM_BASIC_FIELD_RECIPIENT_EMAILS_DESC"
                        multiple="true"
                        min="0"
                        validate="Recipients"
                >
                    <form>
                        <field
                                name="name" type="text" required="true"
                                label="MOD_BPFORM_BASIC_FIELD_RECIPIENT_EMAILS_NAME_LABEL"
                                description="MOD_BPFORM_BASIC_FIELD_RECIPIENT_EMAILS_NAME_DESC"
                        />
                        <field
                                name="email" type="email" required="true"
                                label="MOD_BPFORM_BASIC_FIELD_RECIPIENT_EMAILS_EMAIL_LABEL"
                                description="MOD_BPFORM_BASIC_FIELD_RECIPIENT_EMAILS_EMAIL_DESC"
                                validate="Email"
                        />
                    </form>
                </field>

                <field name="admin_sender_mode" type="radio" filter="INT"
                       default="1" class="btn-group"
                       label="MOD_BPFORM_FIELD_ADMIN_SENDER_MODE_LABEL"
                       description="MOD_BPFORM_FIELD_SENDER_MODE_DESC"
                >
                    <option value="1">MOD_BPFORM_FIELD_SENDER_MODE_REPLYTO</option>
                    <option value="0">MOD_BPFORM_FIELD_SENDER_MODE_SENDER</option>
                </field>

                <field name="visitor_sender_mode" type="radio" filter="INT"
                       default="1" class="btn-group"
                       label="MOD_BPFORM_FIELD_VISITOR_SENDER_MODE_LABEL"
                       description="MOD_BPFORM_FIELD_SENDER_MODE_DESC"
                >
                    <option value="1">MOD_BPFORM_FIELD_SENDER_MODE_REPLYTO</option>
                    <option value="0">MOD_BPFORM_FIELD_SENDER_MODE_SENDER</option>
                </field>

            </fieldset>
            <fieldset name="fields" label="MOD_BPFORM_FIELDSET_FIELDS_LABEL"
                      description="MOD_BPFORM_FIELDSET_FIELDS_DESC"
                      addruleprefix="BPExtensions\Module\BPForm\Site\Form\Rule"
            >
                <field name="show_labels" type="radio" filter="INT"
                       default="1" class="btn-group"
                       label="MOD_BPFORM_FIELD_SHOW_LABELS_LABEL"
                       description="MOD_BPFORM_FIELD_SHOW_LABELS_DESC"
                >
                    <option value="0">JNO</option>
                    <option value="1">JYES</option>
                </field>
                <field name="captcha" type="radio" filter="INT"
                       default="0" class="btn-group"
                       label="MOD_BPFORM_FIELD_CAPTCHA_LABEL"
                       description="MOD_BPFORM_FIELD_CAPTCHA_DESC"
                >
                    <option value="0">JNO</option>
                    <option value="1">JYES</option>
                </field>
                <field name="fields" type="subform" required="true" min="1"
                       formsource="modules/mod_bpform/forms/fields.xml"
                       multiple="true"
                       label="MOD_BPFORM_FIELD_FIELDS_LABEL"
                       description="MOD_BPFORM_FIELD_FIELDS_DESC"
                       validate="Fields"
                />
            </fieldset>
            <fieldset name="message" label="MOD_BPFORM_FIELDSET_MESSAGE_LABEL"
                      description="MOD_BPFORM_FIELDSET_MESSAGE_DESC">

                <field
                        name="message_visitor_note"
                        type="spacer"
                        label="MOD_BPFORM_MESSAGE_VISITOR_NOTE"
                        class="muted"
                />
                <field
                        name="success_message" type="textarea" rows="3"
                        label="MOD_BPFORM_BASIC_FIELD_SUCCESS_MESSAGE_LABEL"
                        description="MOD_BPFORM_BASIC_FIELD_SUCCESS_MESSAGE_DESC"
                        hint="MOD_BPFORM_BASIC_FIELD_SUCCESS_MESSAGE_HINT"/>
                <field
                        name="client_subject" type="text"
                        label="MOD_BPFORM_BASIC_FIELD_SUBJECT_LABEL"
                        description="MOD_BPFORM_BASIC_FIELD_CLIENT_SUBJECT_DESC"
                        hint="MOD_BPFORM_BASIC_FIELD_CLIENT_SUBJECT_HINT"/>
                <field
                        name="intro" type="editor" rows="3" filter="safehtml" height="250"
                        buttons="false"
                        label="MOD_BPFORM_BASIC_FIELD_INTRO_LABEL"
                        description="MOD_BPFORM_BASIC_FIELD_INTRO_DESC"/>
                <field
                        name="message_admin_note"
                        type="spacer"
                        label="MOD_BPFORM_MESSAGE_ADMIN_NOTE"
                        class="muted"
                />
                <field
                        name="admin_subject" type="text"
                        label="MOD_BPFORM_BASIC_FIELD_SUBJECT_LABEL"
                        description="MOD_BPFORM_BASIC_FIELD_ADMIN_SUBJECT_DESC"
                        hint="MOD_BPFORM_BASIC_FIELD_ADMIN_SUBJECT_HINT"/>

            </fieldset>
            <fieldset name="advanced">

                <field
                        name="layout"
                        type="modulelayout"
                        label="JFIELD_ALT_LAYOUT_LABEL"
                        class="form-select"
                        validate="moduleLayout"
                />

                <field
                        name="moduleclass_sfx"
                        type="textarea"
                        label="COM_MODULES_FIELD_MODULECLASS_SFX_LABEL"
                        rows="3"
                        validate="CssIdentifier"
                />

                <field
                        name="owncache"
                        type="list"
                        label="COM_MODULES_FIELD_CACHING_LABEL"
                        default="1"
                        filter="integer"
                        validate="options"
                >
                    <option value="1">JGLOBAL_USE_GLOBAL</option>
                    <option value="0">COM_MODULES_FIELD_VALUE_NOCACHING</option>
                </field>

                <field
                        name="cache_time"
                        type="number"
                        label="COM_MODULES_FIELD_CACHE_TIME_LABEL"
                        default="900"
                        filter="integer"
                />
            </fieldset>
        </fields>
    </config>

    <updateservers>
        <server type="extension" priority="2" name="BP Form">https://free.updates.bpextensions.com/mod_bpform.xml
        </server>
    </updateservers>

</extension>
